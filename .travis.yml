sudo: required
language: node_js
node_js:
- '7'
before_install:
- if [ "$TRAVIS_BRANCH" == "master" ]; then yarn docker:build; fi
- if [ "$TRAVIS_BRANCH" == "master" ]; then yarn docker:run; fi
- curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 0.23.2
- export PATH="$HOME/.yarn/bin:$PATH"
- sh travis/install_chrome.sh
cache: yarn
script:
- yarn travis
services:
- docker
after_success:
- yarn firebase-deploy
- test "$TRAVIS_BRANCH" = "master" && yarn docker:login
- test "$TRAVIS_BRANCH" = "master" && yarn docker:push
- test "$TRAVIS_BRANCH" = "master" && yarn heroku:deploy
deploy:
  edge: true
  provider: bluemixcloudfoundry
  manifest: config/manifest.yml          # (optional)  Defaults to manifest.yml.
  region: eu-gb                        # (optional)  [ng, eu-gb , au-syd] Defaults to US South region (ng).
  api: https://api.eu-gb.bluemix.net
  skip_cleanup: true
  username: $BLUEMIX_USER
  password: $BLUEMIX_PASSWORD
  organization: $BLUEMIX_ORGANIZATION
  space: $BLUEMIX_SPACE
  on:
    branch: master
notifications:
  slack: $SLACK_NOTIFICATION_KEY